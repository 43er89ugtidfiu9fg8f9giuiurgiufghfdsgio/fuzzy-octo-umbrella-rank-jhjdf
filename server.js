const express = require("express");
const axios = require("axios");

const app = express();
app.use(express.json());


const ROBLOSECURITY_COOKIE = "_|WARNING:-DO-NOT-SHARE-THIS.--Sharing-this-will-allow-someone-to-log-in-as-you-and-to-steal-your-ROBUX-and-items.|_365CDC3424549FFE6D98B202AD51E787B191DCC306BA5C8403FBB84F5CA9E0254839E79AD79167DF99996AA1B18CCC3E1E1357C90320A9EE7D8DB923508604D3B1F36F4862CFFC9594C148331FD773BDE8EAA751E7C449691B7DE730C24A68838ACF3FEF38496A015B54DD15A4C9B1C7CA9957AB4FC555FA2E8F869506387BD6BF95FB2D7B7C1C2BB0882DC827AEC95450B205147BA807D01307D55BD3317307D469120F6306C65AB8ABD18092F4AE2DC29EEB04D9009375FFFC3C905F992394E53F752CCD31C6EFC6B15F4BF3574BB816903EB933C5730A25BB61576443465DDB56BC29667AB9A395FB52D44A2E8FBCAA566DDCCC49C56EC779E580B73483BAF525D36DE92A28F1F59BFB6A1FD2E96DCFD0945C9334D657C84F3B57C4EE0C9E6B5AA473E40CE880089FF9751D604C3216D85ECCEF1419F63FE3A11592F36F1056119A963B52297B86B5249423802F66C09EB485F99F023DB6DCE2107B8B04A883564829BE9CE381AC77C10F1DD82A2241140099A87BF44CE2C49A53F2A7BDA190F824700920D7123CE5EE87BB77DBB3E01DE2B07F9E3D977D50D4DACB5B3510937A49ED561316EDE4522BA6A44DD1E9E682D463AD0D5B1D8CD087EB5307AAF5BC15A86F906700E2C4349F8FAE7188D03F90045518FF2FBFC2B6CB5CFEA60C0D5A95F70F385FB2A156F33ED5C41044748CF3E535A5BA15BB39AFB8F41F70D12C5EFC190CDFC6CB7CB12B646AFED00CF18CCBFAECB2BCBD031BC46806FE532C8A5981E67DE8B6A3C2F3BFAE8A0AFDD88B7F609C6346CE336C70E8432BC95C04E56F57ACCA76C3144BAC28150276810592A98508E6FB1A560433C7E9FF5BA833EF515EC12C8D70D00E3E9FA31AD3CF7ADDB5AD867232C22806149E4E12738C9E6FB018D3DC9A6F9B4C40BD852FC61FD82FD334C42A828C2FBF11AEE9D29251E2643F3843DFFA595463102BEECD7AF3720E0A726FFFB5C97ADA411B00BDB3648557F83FE00D0CD87719B35C7EFF3E99F550EBD195D5370830266D781DFEB64615DA0232972B68665B33D190947676597C5B41C9B2C7F19870BCBBD20B6E1060C83D931FF0D48F59A9A5F5F736A914ECA2FC49985C2C2AB3448B5B7C39E0780E04D0199B1CB62295A922320E846A2C5E464D606BA195"; 
const GROUP_ID = 34353316; // Replace with your Roblox Group ID


app.post("/promote", async (req, res) => {
    const { username } = req.body;

    if (!username) {
        return res.status(400).json({ success: false, message: "Username is required." });
    }

    try {
    
        const userResponse = await axios.get(
            `https://users.roblox.com/v1/users/search?keyword=${username}`,
            { headers: { Cookie: `.ROBLOSECURITY=${ROBLOSECURITY_COOKIE}` } }
        );
        const userId = userResponse.data.data[0]?.id;

        if (!userId) {
            return res.status(404).json({ success: false, message: "User not found." });
        }

   
        const rankResponse = await axios.get(
            `https://groups.roblox.com/v1/groups/${GROUP_ID}/users/${userId}`,
            { headers: { Cookie: `.ROBLOSECURITY=${ROBLOSECURITY_COOKIE}` } }
        );
        const currentRank = rankResponse.data.role.rank;


        const promoteResponse = await axios.patch(
            `https://groups.roblox.com/v1/groups/${GROUP_ID}/users/${userId}`,
            { role: currentRank + 1 },
            { headers: { Cookie: `.ROBLOSECURITY=${ROBLOSECURITY_COOKIE}` } }
        );

        res.json({ success: true, message: `${username} promoted successfully.` });
    } catch (error) {
        console.error(error);
        res.status(500).json({ success: false, message: "Error promoting the user." });
    }
});

// Server setup
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`API server running on port ${PORT}`);
});
